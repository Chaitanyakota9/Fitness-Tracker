name: 📊 Fitness Stats Tracker

on:
  schedule:
    # Run every Sunday at 9 AM UTC
    - cron: '0 9 * * 0'
  workflow_dispatch:

jobs:
  fitness-stats:
    runs-on: ubuntu-latest
    steps:
      - name: 📥 Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # Get full history
          
      - name: 🏃‍♀️ Calculate Repository Fitness Stats
        id: stats
        run: |
          # Calculate various "fitness" metrics from repository activity
          
          # Commits this week (like workout sessions)
          commits_this_week=$(git log --since="1 week ago" --oneline | wc -l)
          
          # Lines of code (like calories burned)
          total_lines=$(find . -name "*.js" -o -name "*.json" -o -name "*.html" -o -name "*.css" | xargs wc -l | tail -1 | awk '{print $1}')
          
          # Files changed (like different exercises)
          files_changed=$(git diff --name-only HEAD~7 HEAD 2>/dev/null | wc -l || echo "0")
          
          # Contributors (like workout buddies)
          contributors=$(git log --format='%aN' | sort -u | wc -l)
          
          # Repository age in days (like fitness journey duration)
          repo_age=$(git log --reverse --format=%ad --date=short | head -1)
          if [ ! -z "$repo_age" ]; then
            age_days=$(( ($(date +%s) - $(date -d "$repo_age" +%s)) / 86400 ))
          else
            age_days=0
          fi
          
          echo "commits_this_week=$commits_this_week" >> $GITHUB_OUTPUT
          echo "total_lines=$total_lines" >> $GITHUB_OUTPUT
          echo "files_changed=$files_changed" >> $GITHUB_OUTPUT
          echo "contributors=$contributors" >> $GITHUB_OUTPUT
          echo "age_days=$age_days" >> $GITHUB_OUTPUT
          
          echo "📊 Repository Fitness Stats:"
          echo "  🏃‍♀️ Commits this week: $commits_this_week"
          echo "  💪 Total lines of code: $total_lines"
          echo "  🎯 Files changed: $files_changed"
          echo "  👥 Contributors: $contributors"
          echo "  📅 Repository age: $age_days days"

      - name: 🏆 Generate Fitness Report
        run: |
          # Create a fun fitness report
          cat > fitness-report.md << EOF
          # 🏋️‍♀️ Repository Fitness Report - Week of $(date '+%B %d, %Y')
          
          ## 📊 This Week's Stats
          
          | Metric | Value | Fitness Equivalent |
          |--------|-------|-------------------|
          | 🏃‍♀️ Commits | ${{ steps.stats.outputs.commits_this_week }} | Workout sessions |
          | 💪 Lines of Code | ${{ steps.stats.outputs.total_lines }} | Calories burned |
          | 🎯 Files Changed | ${{ steps.stats.outputs.files_changed }} | Different exercises |
          | 👥 Contributors | ${{ steps.stats.outputs.contributors }} | Workout buddies |
          | 📅 Project Age | ${{ steps.stats.outputs.age_days }} days | Fitness journey |
          
          ## 🏆 Fitness Level Assessment
          
          EOF
          
          # Add fitness level based on commits
          commits=${{ steps.stats.outputs.commits_this_week }}
          if [ $commits -ge 10 ]; then
            echo "🔥 **FITNESS LEVEL: ELITE ATHLETE** 🔥" >> fitness-report.md
            echo "You're crushing it! More than 10 commits this week shows incredible dedication!" >> fitness-report.md
          elif [ $commits -ge 5 ]; then
            echo "💪 **FITNESS LEVEL: FITNESS ENTHUSIAST** 💪" >> fitness-report.md
            echo "Great work! 5+ commits shows you're staying consistent with your fitness goals!" >> fitness-report.md
          elif [ $commits -ge 2 ]; then
            echo "🏃‍♀️ **FITNESS LEVEL: ACTIVE** 🏃‍♀️" >> fitness-report.md
            echo "Good progress! A few commits this week shows you're building healthy habits!" >> fitness-report.md
          else
            echo "🌱 **FITNESS LEVEL: GETTING STARTED** 🌱" >> fitness-report.md
            echo "Every journey begins with a single step! Keep pushing forward!" >> fitness-report.md
          fi
          
          cat >> fitness-report.md << EOF
          
          ## 🎯 Next Week's Goals
          
          - [ ] Aim for at least 3 commits (workout sessions)
          - [ ] Add new features (try new exercises)
          - [ ] Review and refactor code (stretch and recover)
          - [ ] Update documentation (track your progress)
          
          ## 💡 Fitness Tips for Developers
          
          - Take breaks every hour to stretch
          - Stay hydrated while coding
          - Use a standing desk if possible
          - Go for a walk during lunch breaks
          - Track your coding time like you track workouts
          
          ---
          *Generated by GitHub Actions - Your repository's fitness coach!* 🏋️‍♀️
          EOF

      - name: 📝 Commit Fitness Report
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add fitness-report.md
          git commit -m "📊 Weekly fitness stats report - $(date '+%B %d, %Y')" || exit 0
          git push
